{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\User\\\\Desktop\\\\Project3Lessons\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\User\\\\Desktop\\\\Project3Lessons\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';// import Layout from '../core/Layout';\nimport axios from'axios';import'react-toastify/dist/ReactToastify.min.css';import{isAuth,getCookie}from'../../../auth/helpers';import'./style.css';var UserBookmark=function UserBookmark(_ref){var history=_ref.history;var _useState=useState({UserId:\"\",LessonId:\"\",BookmarkId:\"\",isBookmarked:false}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var token=getCookie('token');var loadProfile=function loadProfile(){//grabbing the URL from the window\nvar URLarray=window.document.URL.split(\"/\");var URLarrVar=URLarray[URLarray.length-1];var URL_id=URLarrVar.split(\"?\");//GET the correct logged user\naxios({method:'GET',url:\"\".concat(process.env.REACT_APP_API,\"/user/\").concat(isAuth()._id),headers:{Authorization:\"Bearer \".concat(token)}}).then(function(response){//set all the values of the user\nif(response.data.notes.length===0){//if the user has notes identify if there is a bookmark that belong to this lesson\n}else{response.data.bookmarks.map(function(bookmark){if(bookmark.Lesson_id===URL_id[0]){setValues(_objectSpread({},values,{BookmarkId:bookmark._id,isBookmarked:true}));}});}});};useEffect(function(){loadProfile();},[]);var BookmarkId=values.BookmarkId,isBookmarked=values.isBookmarked;//handle all edits to the bookmark as a POST\nvar postBookmark=function postBookmark(){var URLarray=window.document.URL.split(\"/\");var URLarrVar=URLarray[URLarray.length-1];var URL_id=URLarrVar.split(\"?\");axios({method:'GET',url:\"\".concat(process.env.REACT_APP_API,\"/user/\").concat(isAuth()._id),headers:{Authorization:\"Bearer \".concat(token)}}).then(function(response){var userId=response.data._id;axios({method:'GET',url:process.env.REACT_APP_API+'/lesson/'+URL_id}).then(function(res){var lessonTitle=res.data.title;axios({method:\"POST\",url:process.env.REACT_APP_API+'/user/bookmarks/'+URL_id[0],headers:{Authorization:'Bearer '+token},data:{User_id:userId,lesson_title:lessonTitle}}).then(function(response){setValues({isBookmarked:true});});});});};var deleteBookmark=function deleteBookmark(){axios({method:'DELETE',url:\"\".concat(process.env.REACT_APP_API,\"/bookmarks/\")+BookmarkId,headers:{Authorization:'Bearer '+token}}).then(function(response){setValues({isBookmarked:false});});};function Image(){if(isBookmarked){return React.createElement(\"img\",{src:'/images/bookmark-ribbon.png',id:\"bookmark-lesson\",alt:\"bookmark\"});}else{return\"\";}}function BookmarkButton(){if(isBookmarked){return\"\";}else{return React.createElement(\"div\",{id:\"btn-bookmark\",onClick:function onClick(){return postBookmark();}},\"Bookmark\");}}function RemoveBookmark(){if(isBookmarked){return React.createElement(\"button\",{id:\"btn-removeBookmark\",onClick:function onClick(){return deleteBookmark();}},\"Remove\");}else{return\"\";}}// what the user is viewing\nreturn React.createElement(\"div\",null,React.createElement(BookmarkButton,null),React.createElement(RemoveBookmark,null),React.createElement(\"div\",{id:\"bookmark-container\"},React.createElement(Image,null)));};export default UserBookmark;","map":{"version":3,"sources":["C:/Users/User/Desktop/Project3Lessons/client/src/core/pages/Lesson/UserBookmark.js"],"names":["React","useState","useEffect","axios","isAuth","getCookie","UserBookmark","history","UserId","LessonId","BookmarkId","isBookmarked","values","setValues","token","loadProfile","URLarray","window","document","URL","split","URLarrVar","length","URL_id","method","url","process","env","REACT_APP_API","_id","headers","Authorization","then","response","data","notes","bookmarks","map","bookmark","Lesson_id","postBookmark","userId","res","lessonTitle","title","User_id","lesson_title","deleteBookmark","Image","BookmarkButton","RemoveBookmark"],"mappings":"6QAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA;AACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,2CAAP,CACA,OAASC,MAAT,CAAiBC,SAAjB,KAAkC,uBAAlC,CACA,MAAO,aAAP,CAGA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAiB,IAAdC,CAAAA,OAAc,MAAdA,OAAc,eACNN,QAAQ,CAAC,CACjCO,MAAM,CAAE,EADyB,CAEjCC,QAAQ,CAAE,EAFuB,CAGjCC,UAAU,CAAE,EAHqB,CAIjCC,YAAY,CAAE,KAJmB,CAAD,CADF,wCAC3BC,MAD2B,eACnBC,SADmB,eAQlC,GAAMC,CAAAA,KAAK,CAAGT,SAAS,CAAC,OAAD,CAAvB,CAGA,GAAMU,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACtB;AACA,GAAMC,CAAAA,QAAQ,CAAGC,MAAM,CAACC,QAAP,CAAgBC,GAAhB,CAAoBC,KAApB,CAA0B,GAA1B,CAAjB,CACA,GAAMC,CAAAA,SAAS,CAAGL,QAAQ,CAACA,QAAQ,CAACM,MAAT,CAAkB,CAAnB,CAA1B,CACA,GAAMC,CAAAA,MAAM,CAAGF,SAAS,CAACD,KAAV,CAAgB,GAAhB,CAAf,CAEA;AACAjB,KAAK,CAAC,CACFqB,MAAM,CAAE,KADN,CAEFC,GAAG,WAAKC,OAAO,CAACC,GAAR,CAAYC,aAAjB,kBAAuCxB,MAAM,GAAGyB,GAAhD,CAFD,CAGFC,OAAO,CAAE,CACLC,aAAa,kBAAYjB,KAAZ,CADR,CAHP,CAAD,CAAL,CAOKkB,IAPL,CAOU,SAAAC,QAAQ,CAAI,CACd;AACA,GAAIA,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBb,MAApB,GAA+B,CAAnC,CAAsC,CAClC;AACH,CAFD,IAEO,CACHW,QAAQ,CAACC,IAAT,CAAcE,SAAd,CAAwBC,GAAxB,CAA4B,SAAAC,QAAQ,CAAI,CACpC,GAAIA,QAAQ,CAACC,SAAT,GAAuBhB,MAAM,CAAC,CAAD,CAAjC,CAAsC,CAClCV,SAAS,kBAAMD,MAAN,EAAcF,UAAU,CAAC4B,QAAQ,CAACT,GAAlC,CAAuClB,YAAY,CAAE,IAArD,GAAT,CAEH,CACJ,CALD,EAMH,CAEJ,CApBL,EAqBC,CA5BL,CA8BIT,SAAS,CAAC,UAAM,CACZa,WAAW,GACd,CAFQ,CAEN,EAFM,CAAT,CAzC8B,GA8C1BL,CAAAA,UA9C0B,CA8CGE,MA9CH,CA8C1BF,UA9C0B,CA8CdC,YA9Cc,CA8CGC,MA9CH,CA8CdD,YA9Cc,CAgDlC;AACA,GAAM6B,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB,GAAMxB,CAAAA,QAAQ,CAAGC,MAAM,CAACC,QAAP,CAAgBC,GAAhB,CAAoBC,KAApB,CAA0B,GAA1B,CAAjB,CACA,GAAMC,CAAAA,SAAS,CAAGL,QAAQ,CAACA,QAAQ,CAACM,MAAT,CAAkB,CAAnB,CAA1B,CACA,GAAMC,CAAAA,MAAM,CAAGF,SAAS,CAACD,KAAV,CAAgB,GAAhB,CAAf,CACAjB,KAAK,CAAC,CACFqB,MAAM,CAAE,KADN,CAEFC,GAAG,WAAKC,OAAO,CAACC,GAAR,CAAYC,aAAjB,kBAAuCxB,MAAM,GAAGyB,GAAhD,CAFD,CAGFC,OAAO,CAAE,CACLC,aAAa,kBAAYjB,KAAZ,CADR,CAHP,CAAD,CAAL,CAOKkB,IAPL,CAOU,SAAAC,QAAQ,CAAI,CACd,GAAMQ,CAAAA,MAAM,CAAGR,QAAQ,CAACC,IAAT,CAAcL,GAA7B,CACA1B,KAAK,CAAC,CACFqB,MAAM,CAAE,KADN,CAEFC,GAAG,CAACC,OAAO,CAACC,GAAR,CAAYC,aAAZ,CAA0B,UAA1B,CAAqCL,MAFvC,CAAD,CAAL,CAGGS,IAHH,CAGS,SAAAU,GAAG,CAAI,CACZ,GAAMC,CAAAA,WAAW,CAAGD,GAAG,CAACR,IAAJ,CAASU,KAA7B,CACAzC,KAAK,CAAC,CACFqB,MAAM,CAAE,MADN,CAEFC,GAAG,CAAEC,OAAO,CAACC,GAAR,CAAYC,aAAZ,CAA4B,kBAA5B,CAAiDL,MAAM,CAAC,CAAD,CAF1D,CAGFO,OAAO,CAAE,CACLC,aAAa,CAAE,UAAYjB,KADtB,CAHP,CAMFoB,IAAI,CAAE,CAAEW,OAAO,CAAEJ,MAAX,CAAmBK,YAAY,CAAEH,WAAjC,CANJ,CAAD,CAAL,CAOGX,IAPH,CAOQ,SAAAC,QAAQ,CAAI,CAChBpB,SAAS,CAAC,CAAEF,YAAY,CAAE,IAAhB,CAAD,CAAT,CAEH,CAVD,EAWH,CAhBD,EAiBH,CA1BL,EA2BH,CA/BD,CAiCA,GAAMoC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CACrB5C,KAAK,CAAC,CACFqB,MAAM,CAAE,QADN,CAEFC,GAAG,CAAE,UAAGC,OAAO,CAACC,GAAR,CAAYC,aAAf,gBAA4ClB,UAF/C,CAGFoB,OAAO,CAAE,CACLC,aAAa,CAAE,UAAYjB,KADtB,CAHP,CAAD,CAAL,CAOKkB,IAPL,CAOU,SAAAC,QAAQ,CAAI,CACdpB,SAAS,CAAC,CAAEF,YAAY,CAAE,KAAhB,CAAD,CAAT,CACH,CATL,EAUP,CAXD,CAaA,QAASqC,CAAAA,KAAT,EAAiB,CACb,GAAIrC,YAAJ,CAAkB,CACd,MAAO,4BAAK,GAAG,CAAE,6BAAV,CAAyC,EAAE,CAAC,iBAA5C,CAA8D,GAAG,CAAC,UAAlE,EAAP,CACH,CAFD,IAEO,CACH,MAAO,EAAP,CACH,CACJ,CAED,QAASsC,CAAAA,cAAT,EAA0B,CACtB,GAAItC,YAAJ,CAAkB,CACd,MAAO,EAAP,CACH,CAFD,IAEO,CACH,MAAO,4BAAK,EAAE,CAAC,cAAR,CAAuB,OAAO,CAAE,yBAAI6B,CAAAA,YAAY,EAAhB,EAAhC,aAAP,CACH,CACJ,CAED,QAASU,CAAAA,cAAT,EAA0B,CACtB,GAAIvC,YAAJ,CAAkB,CACd,MAAO,+BAAQ,EAAE,CAAC,oBAAX,CAAgC,OAAO,CAAE,yBAAIoC,CAAAA,cAAc,EAAlB,EAAzC,WAAP,CACH,CAFD,IAEO,CACH,MAAO,EAAP,CACH,CACJ,CAGD;AACA,MACI,gCACI,oBAAC,cAAD,MADJ,CAEI,oBAAC,cAAD,MAFJ,CAGQ,2BAAK,EAAE,CAAC,oBAAR,EACJ,oBAAC,KAAD,MADI,CAHR,CADJ,CASH,CAlID,CAoIA,cAAezC,CAAAA,YAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\r\n// import Layout from '../core/Layout';\r\nimport axios from 'axios';\r\nimport 'react-toastify/dist/ReactToastify.min.css';\r\nimport { isAuth, getCookie } from '../../../auth/helpers';\r\nimport './style.css'\r\n\r\n\r\nconst UserBookmark = ({ history }) => {\r\n    const [values, setValues] = useState({\r\n        UserId: \"\",\r\n        LessonId: \"\",\r\n        BookmarkId: \"\", \r\n        isBookmarked: false\r\n    });\r\n\r\n    const token = getCookie('token');\r\n\r\n    \r\n    const loadProfile = () => {\r\n        //grabbing the URL from the window\r\n        const URLarray = window.document.URL.split(\"/\")\r\n        const URLarrVar = URLarray[URLarray.length - 1]\r\n        const URL_id = URLarrVar.split(\"?\")\r\n        \r\n        //GET the correct logged user\r\n        axios({\r\n            method: 'GET',\r\n            url: `${process.env.REACT_APP_API}/user/${isAuth()._id}`,\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        })\r\n            .then(response => {\r\n                //set all the values of the user\r\n                if (response.data.notes.length === 0) {\r\n                    //if the user has notes identify if there is a bookmark that belong to this lesson\r\n                } else {\r\n                    response.data.bookmarks.map(bookmark => {\r\n                        if (bookmark.Lesson_id === URL_id[0]) {\r\n                            setValues({ ...values, BookmarkId:bookmark._id, isBookmarked: true })\r\n                            \r\n                        }\r\n                    })\r\n                }\r\n                \r\n            })\r\n        };\r\n        \r\n        useEffect(() => {\r\n            loadProfile();\r\n        }, []);\r\n\r\n\r\n    const { BookmarkId, isBookmarked } = values;\r\n\r\n    //handle all edits to the bookmark as a POST\r\n    const postBookmark = () => {\r\n        const URLarray = window.document.URL.split(\"/\")\r\n        const URLarrVar = URLarray[URLarray.length - 1]\r\n        const URL_id = URLarrVar.split(\"?\")\r\n        axios({\r\n            method: 'GET',\r\n            url: `${process.env.REACT_APP_API}/user/${isAuth()._id}`,\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        })\r\n            .then(response => {\r\n                const userId = response.data._id\r\n                axios({\r\n                    method: 'GET',\r\n                    url:process.env.REACT_APP_API+'/lesson/'+URL_id\r\n                }).then( res => {\r\n                    const lessonTitle = res.data.title\r\n                    axios({\r\n                        method: \"POST\",\r\n                        url: process.env.REACT_APP_API + '/user/bookmarks/' + URL_id[0],\r\n                        headers: {\r\n                            Authorization: 'Bearer ' + token\r\n                        },\r\n                        data: { User_id: userId, lesson_title: lessonTitle}\r\n                    }).then(response => {\r\n                        setValues({ isBookmarked: true})\r\n\r\n                    })\r\n                })\r\n            })\r\n    }\r\n\r\n    const deleteBookmark = () => {\r\n            axios({\r\n                method: 'DELETE',\r\n                url: `${process.env.REACT_APP_API}/bookmarks/` + BookmarkId,\r\n                headers: {\r\n                    Authorization: 'Bearer ' + token\r\n                }\r\n            })\r\n                .then(response => {\r\n                    setValues({ isBookmarked: false})\r\n                });\r\n    }\r\n\r\n    function Image() {\r\n        if (isBookmarked) {\r\n            return <img src={'/images/bookmark-ribbon.png'} id=\"bookmark-lesson\" alt=\"bookmark\"/>\r\n        } else {\r\n            return \"\"\r\n        }\r\n    }\r\n\r\n    function BookmarkButton() {\r\n        if (isBookmarked) {\r\n            return \"\"\r\n        } else {\r\n            return <div id=\"btn-bookmark\" onClick={()=>postBookmark()}>Bookmark</div>\r\n        }\r\n    }\r\n\r\n    function RemoveBookmark() {\r\n        if (isBookmarked) {\r\n            return <button id=\"btn-removeBookmark\" onClick={()=>deleteBookmark()}>Remove</button>\r\n        } else {\r\n            return \"\"\r\n        }\r\n    }\r\n\r\n\r\n    // what the user is viewing\r\n    return (\r\n        <div>\r\n            <BookmarkButton />\r\n            <RemoveBookmark />\r\n                <div id=\"bookmark-container\">\r\n            <Image />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default UserBookmark;"]},"metadata":{},"sourceType":"module"}
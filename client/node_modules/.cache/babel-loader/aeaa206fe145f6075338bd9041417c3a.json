{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\User\\\\Desktop\\\\Project3Lessons\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:\\\\Users\\\\User\\\\Desktop\\\\Project3Lessons\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\User\\\\Desktop\\\\Project3Lessons\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import{isAuth,getCookie,signout,updateUser}from'../../../../auth/helpers';import{toast}from'react-toastify';import'react-toastify/dist/ReactToastify.min.css';import'../style.css';var Settings=function Settings(_ref){var history=_ref.history;var _useState=useState({role:'',name:'',email:'',password:'',btnText:'Submit'}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var token=getCookie('token');useEffect(function(){loadProfile();},[]);var loadProfile=function loadProfile(){axios({method:'GET',url:\"\".concat(process.env.REACT_APP_API,\"/user/\").concat(isAuth()._id),headers:{Authorization:\"Bearer \".concat(token)}}).then(function(response){console.log('PRIVATE PROFILE UPDATE',response);var _response$data=response.data,role=_response$data.role,name=_response$data.name,email=_response$data.email;setValues(_objectSpread({},values,{role:role,name:name,email:email}));}).catch(function(error){console.log('PRIVATE PROFILE UPDATE ERROR',error.response.data.error);if(error.response.status===401){signout(function(){history.push('/');});}});};var role=values.role,name=values.name,email=values.email,password=values.password,btnText=values.btnText;var handleChange=function handleChange(name){return function(event){setValues(_objectSpread({},values,_defineProperty({},name,event.target.value)));};};var clickSubmit=function clickSubmit(event){event.preventDefault();setValues(_objectSpread({},values,{btnText:'Updating'}));axios({method:'PUT',url:\"\".concat(process.env.REACT_APP_API,\"/user/update\"),headers:{Authorization:'Bearer '+token},data:{name:name,password:password}}).then(function(response){console.log('Profile is updated',response);updateUser(response,function(){setValues(_objectSpread({},values,{btnText:'Updated'}));toast.success('Profile updated successfully');});}).catch(function(error){console.log('Error updating profile',error.response.data.error);setValues(_objectSpread({},values,{btnText:'Update'}));toast.error(error.response.data.error);});};var updateForm=function updateForm(){return React.createElement(\"form\",null,React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{className:\"text-muted  settings-label\"},\"Role:\"),React.createElement(\"input\",{defaultValue:role,type:\"text\",className:\"form-control settings-form\",disabled:true})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{className:\"text-muted  settings-label\"},\"Name:\"),React.createElement(\"input\",{onChange:handleChange('name'),value:name,type:\"text\",className:\"form-control settings-form\"})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{className:\"text-muted  settings-label\"},\"Email:\"),React.createElement(\"input\",{defaultValue:email,type:\"email\",className:\"form-control settings-form\",disabled:true})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{className:\"text-muted settings-label\"},\"Password:\"),React.createElement(\"input\",{onChange:handleChange('password'),value:password,type:\"password\",className:\"form-control settings-form\"})),React.createElement(\"div\",{className:\"settings-submit-btn\"},React.createElement(\"button\",{className:\"btn btn-warning settings-submit\",onClick:clickSubmit},btnText)));};return React.createElement(\"div\",{className:\"col-md-6 offset-md-3\"},updateForm());};export default Settings;","map":{"version":3,"sources":["C:/Users/User/Desktop/Project3Lessons/client/src/core/pages/Admin/components/Settings.js"],"names":["React","useState","useEffect","axios","isAuth","getCookie","signout","updateUser","toast","Settings","history","role","name","email","password","btnText","values","setValues","token","loadProfile","method","url","process","env","REACT_APP_API","_id","headers","Authorization","then","response","console","log","data","catch","error","status","push","handleChange","event","target","value","clickSubmit","preventDefault","success","updateForm"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { isAuth, getCookie, signout, updateUser } from '../../../../auth/helpers';\r\nimport { toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.min.css';\r\nimport '../style.css'\r\n\r\n\r\nconst Settings = ({ history }) => {\r\n    const [values, setValues] = useState({\r\n        role: '',\r\n        name: '',\r\n        email: '',\r\n        password: '',\r\n        btnText: 'Submit'\r\n    });\r\n\r\n    const token = getCookie('token');\r\n\r\n    useEffect(() => {\r\n        loadProfile();\r\n    }, []);\r\n\r\n    const loadProfile = () => {\r\n        axios({\r\n            method: 'GET',\r\n            url: `${process.env.REACT_APP_API}/user/${isAuth()._id}`,\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        })\r\n            .then(response => {\r\n                console.log('PRIVATE PROFILE UPDATE', response);\r\n                const { role, name, email } = response.data;\r\n                setValues({ ...values, role, name, email });\r\n            })\r\n            .catch(error => {\r\n                console.log('PRIVATE PROFILE UPDATE ERROR', error.response.data.error);\r\n                if (error.response.status === 401) {\r\n                    signout(() => {\r\n                        history.push('/');\r\n                    });\r\n                }\r\n            });\r\n    };\r\n\r\n    const { role, name, email, password, btnText } = values;\r\n\r\n    const handleChange = name => event => {\r\n        setValues({ ...values, [name]: event.target.value });\r\n    };\r\n\r\n    const clickSubmit = event => {\r\n        event.preventDefault();\r\n        setValues({ ...values, btnText: 'Updating' });\r\n        axios({\r\n            method: 'PUT',\r\n            url: `${process.env.REACT_APP_API}/user/update`,\r\n            headers: {\r\n                Authorization: 'Bearer '+ token\r\n            },\r\n            data: { name, password }\r\n        })\r\n            .then(response => {\r\n                console.log('Profile is updated', response);\r\n                updateUser(response, () => {\r\n                    setValues({ ...values, btnText: 'Updated' });\r\n                    toast.success('Profile updated successfully');\r\n                });\r\n            })\r\n            .catch(error => {\r\n                console.log('Error updating profile', error.response.data.error);\r\n                setValues({ ...values, btnText: 'Update' });\r\n                toast.error(error.response.data.error);\r\n            });\r\n    };\r\n\r\n    const updateForm = () => (\r\n        <form>\r\n            <div className=\"form-group\">\r\n            <label className=\"text-muted  settings-label\">Role:</label>\r\n                <input defaultValue={role} type=\"text\" className=\"form-control settings-form\" disabled />\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted  settings-label\">Name:</label>\r\n                <input onChange={handleChange('name')} value={name} type=\"text\" className=\"form-control settings-form\" />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted  settings-label\">Email:</label>\r\n                <input defaultValue={email} type=\"email\" className=\"form-control settings-form\" disabled />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted settings-label\">Password:</label>\r\n                <input onChange={handleChange('password')} value={password} type=\"password\" className=\"form-control settings-form\" />\r\n            </div>\r\n\r\n            <div className=\"settings-submit-btn\">\r\n                <button className=\"btn btn-warning settings-submit\" onClick={clickSubmit}>\r\n                    {btnText}\r\n                </button>\r\n            </div>\r\n        </form>\r\n    );\r\n\r\n    return (\r\n            <div className=\"col-md-6 offset-md-3\">\r\n                {updateForm()}\r\n            </div>\r\n    );\r\n};\r\n\r\nexport default Settings;"]},"metadata":{},"sourceType":"module"}